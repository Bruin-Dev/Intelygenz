{
    "widgets":[
        {
            "type":"metric",
            "x":0,
            "y":0,
            "width":6,
            "height":6,
            "properties":{
                "metrics":[
                    [
                        "ECS/ContainerInsights",
                        "RunningTaskCount",
                        "ServiceName",
                        "${ENVIRONMENT}-metrics-prometheus",
                        "ClusterName",
                        "${ENVIRONMENT}",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-1",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-2",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-3",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-4",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-triage",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-velocloud-bridge",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-last-contact-report",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-bruin-bridge",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-nats-server-1",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-nats-server-2",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-nats-server",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-affecting-monitor",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-t7-bridge",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-sites-monitor",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-notifier",
                        ".",
                        ".",
                        {
                            "period":300,
                            "stat":"Sum"
                        }
                    ]
                ],
                "view":"timeSeries",
                "stacked":false,
                "title":"Sum of Running Tasks By Service",
                "region":"us-east-1",
                "period":300
            }
        },
        {
            "type":"metric",
            "x":6,
            "y":0,
            "width":6,
            "height":6,
            "properties":{
                "view":"timeSeries",
                "stacked":false,
                "metrics":[
                    [
                        "ECS/ContainerInsights",
                        "CpuUtilized",
                        "ServiceName",
                        "${ENVIRONMENT}-nats-server",
                        "ClusterName",
                        "${ENVIRONMENT}"
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-bruin-bridge",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-last-contact-report",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-velocloud-bridge",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-affecting-monitor",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-notifier",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-sites-monitor",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-t7-bridge",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-metrics-prometheus",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-1",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-2",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-3",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-4",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-triage",
                        ".",
                        "."
                    ]
                ],
                "region":"us-east-1",
                "title":"Average of CpuUtilized by Service",
                "period":300
            }
        },
        {
            "type":"metric",
            "x":12,
            "y":0,
            "width":6,
            "height":6,
            "properties":{
                "metrics":[
                    [
                        "ECS/ContainerInsights",
                        "MemoryUtilized",
                        "ServiceName",
                        "${ENVIRONMENT}-bruin-bridge",
                        "ClusterName",
                        "${ENVIRONMENT}",
                        {
                            "stat":"Average"
                        }
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-last-contact-report",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-affecting-monitor",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-notifier",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-sites-monitor",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-velocloud-bridge",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-1",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-2",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-3",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-4",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-service-outage-monitor-triage",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-t7-bridge",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-metrics-prometheus",
                        ".",
                        "."
                    ],
                    [
                        "...",
                        "${ENVIRONMENT}-nats-server",
                        ".",
                        "."
                    ]
                ],
                "view":"timeSeries",
                "stacked":false,
                "region":"us-east-1",
                "title":"Average of MemoryUtilized by Service",
                "period":300
            }
        },
        {
            "type":"log",
            "x":0,
            "y":12,
            "width":24,
            "height":6,
            "properties":{
                "query":"SOURCE '${ENVIRONMENT}' | fields @timestamp, @message as exception_msg | filter @message like /Exception/ | parse @logStream /(?<environment>^${ENVIRONMENT}-latest)\\/(?<microservice_name>[\\w-]+)\\/(?<task_id>.*$)/",
                "region":"us-east-1",
                "stacked":false,
                "view":"table",
                "title":"Exception messages detected in services"
            }
        },
        {
            "type":"log",
            "x":0,
            "y":18,
            "width":24,
            "height":6,
            "properties":{
                "query":"SOURCE '${ENVIRONMENT}' | fields @timestamp, @message as error_msg | filter @message like \": ERROR\" | parse @logStream /(?<environment>^${ENVIRONMENT}-latest)\\/(?<microservice_name>[\\w-]+)\\/(?<task_id>.*$)/",
                "region":"us-east-1",
                "title":"Error messages detected in services",
                "view":"table"
            }
        }
    ]
}