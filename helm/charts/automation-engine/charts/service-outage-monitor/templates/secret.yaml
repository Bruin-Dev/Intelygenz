{{- range $index, $host := .Values.config.monitoring__monitored_velocloud_hosts }}
---
apiVersion: v1
kind: Secret
metadata:
  name: "{{ include "service-outage-monitor.fullname" $ }}{{ $index | add1 }}-{{ $host | replace "." "-" }}-secret"
  labels:
    {{- include "service-outage-monitor.labels" $ | nindent 4 }}
    velocloud_host: {{ $host | quote }}
    velocloud_host_id: {{ $index | add1 | quote }}
  annotations:
    reloader.stakater.com/match: "true"
data:
  MONITORED_PRODUCT_CATEGORY: {{ $.Values.config.monitored_product_category | b64enc }}
  MONITORING__VELOCLOUD_HOST: {{ $host | b64enc }}
  MONITORING__MISSING_EDGES_FROM_CACHE_REPORT_RECIPIENT: {{ $.Values.config.monitoring__missing_edges_from_cache_report_recipient | b64enc }}
  MONITORING__LINK_LABELS_BLACKLISTED_IN_ASR_FORWARDS: {{ mustToJson $.Values.config.monitoring__link_labels_blacklisted_in_asr_forwards | b64enc }}
  MONITORING__BLACKLISTED_EDGES: {{ mustToJson $.Values.config.monitoring__blacklisted_edges | b64enc }}
{{- end }}